search:
  samples: 1
  nodes: 1
  node_types: 'pascal,volta'

  # doesnt really work to have different cpu counts as tune.run(..., resources_per_trial={"cpu":...}) needs to be set
  node_type_cpus: '5,5'
  grace_period: 0
  reduction_factor: 0
  username: ''
  keyfile: ''
  proxy: ''
  host: ''
  port: 0

training:
  trial: 'terrst'
  name: 'v0'
  cache: 'cache'
  output: 'output'
  batch_size: !h_int 32
  batch_mem: 32000
  gpu: 1
  epochs: 25
  print_freq: 5
  test_freq: 1
  save_freq: 1
  resume: null
  evaluate: 0
  pretrained: ''
  early_stopping: 5
  reduced_precision: 0
  auto_lr_find: 0
  deterministic: 1

model:
  arch: !h_str 'mob-mn3_L'
  in_channels:      !h_int    3
  partial_residual: !h_int    0
  width_mult:       !h_float  1.0
  pretrained: 0         # not in use
  cache_dir: 'cache'    # not in use
  des_head:
    dimensions:  !h_int    128
    hidden_ch:   !h_int    128
    exp_coef:    !h_float  6.0
    use_se:      !h_int    0
    dropout:     !h_float  0.0
  det_head:
    hidden_ch:   !h_int    128
    exp_coef:    !h_float  6.0
    use_se:      !h_int    0
    dropout:     !h_float  0.0
  qlt_head:
    hidden_ch:   !h_int    128
    exp_coef:    !h_float  6.0
    use_se:      !h_int    0
    dropout:     !h_float  0.0

loss:
  teacher: !h_str  'output/r2d2_WASF_N16.pt'
  des_loss: !h_str 'L1'     # L1 or L2
  des_w: !h_float -10.0     # weight for descriptor head loss
  det_w: !h_float -0.8      # weight for detector head loss
  qlt_w: !h_float -3.0      # weight for quality head loss

optimizer:
  method: 'adam'
  learning_rate: !h_float 3e-4
  weight_decay: !h_float 1e-5
  split_params: 0
  eps: !!float 1e-8

data:
  max_rot: !h_float 8.0      # in degrees, synth pair warp related
  max_shear: !h_float 0.2    # synth pair warp related
  max_proj: !h_float 0.4     # synth pair warp related
  noise_max: !h_float 0.07
  rnd_gain: !h_float 1.5
  student_rnd_gain: !h_float 1.2
  student_noise_sd: !h_float 0.05
  image_size: !h_int 224
  path: 'data'
  npy: 'false'
  trn_ratio: 0.8
  val_ratio: 0.1
  tst_ratio: 0.1
  workers: 6
